{%- macro form_field(field, btn_type, btn_color, bottom_margin, autofocus_first) %}
  {%- if field.type == "BooleanField" %}
  <div class="form-check mb-{{ bottom_margin }}">
     {{ field(id=field.name ~ "-input", class="form-check-input") }}
     {{ field.label(class="form-check-label") }}
     <div class="invalid-feedback" aria-describedby="{{ field.name }}"></div>
   </div>

  {%- elif field.type == "RadioField" %}
    {{ field.label(class="form-label") }}
    {%- for item in field %}
    <div class="form-check{%- if loop.last %} mb-{{ bottom_margin }}{%- endif %}">
      {{ item(class="form-check-input") }}
      {{ item.label(class="form-check-label") }}
    </div>
    {%- endfor %}

  {%- elif field.type == "SelectField" %}
    {{ field.label(class="form-label") }}
    {{ field(id=field.name ~ "-input", class="form-select mb-" ~ bottom_margin) }}
    <div class="invalid-feedback" aria-describedby="{{ field.name }}"></div>

  {%- elif field.type == "TextAreaField" %}
  <div class="mb-{{ bottom_margin }}">
      {{ field.label(class="form-label") }}
      <div class="input-group has-validation">
        {%- if autofocus_focus %}
          {{ field(id=field.name ~ "-input", class="form-control" ~ (" is-invalid" if field.errors else ""), autofocus=True) }}
        {%- else %}
          {{ field(id=field.name ~ "-input", class="form-control" ~ (" is-invalid" if field.errors else "")) }}
        {%- endif %}

        <div class="invalid-feedback" aria-describedby="{{ field.name }}"></div>
      </div>
    </div>

  {%- elif field.type == "SubmitField" %}
    {%- if btn_type == "no-bg" %}
      {{ field(class="btn btn-link btn-link--" ~ btn_color ~ " mb-" ~ bottom_margin ~ " no-underline") }}
    {%- else %}
      {{ field(class="btn btn-" ~ btn_type ~ " btn--" ~ btn_color ~ " mb-" ~ bottom_margin) }}
    {%- endif %}

  {%- else %}
    <div class="mb-{{ bottom_margin }}">
      {{ field.label(class="form-label") }}
      <div class="input-group has-validation">
        {%- if autofocus_first %}
          {{ field(id=field.name ~ "-input", class="form-control" ~ (" is-invalid" if field.errors else ""), autofocus=True) }}
        {%- else %}
          {{ field(id=field.name ~ "-input", class="form-control" ~ (" is-invalid" if field.errors else "")) }}
        {%- endif %}

        {%- if field.type == "PasswordField" %}
          <i id="{{ field.name }}-show" class="toggle--password-visibility bi bi-eye-slash ps-3" data-target="{{ field.name }}-input"></i>
        {%- endif %}

        <div class="invalid-feedback" aria-describedby="{{ field.name }}"></div>
      </div>
    </div>
  {%- endif %}
{%- endmacro %}


{%- macro quick_form(form, action="", method="post", class="", id="", novalidate=False, btn_type="primary", btn_color="custom-orange", bottom_margin=3, autofocus_first=true, hidden=false) %}
  <form novalidate
    {%- if action != None %} action="{{ action }}"{%- endif %}
    {%- if method %} method="{{ method }}"{%- endif %}
    {%- if class %} class="{{ class }}"{%- endif %}
    {%- if id %} id="{{ id }}"{%- endif %}
    {%- if novalidate %} novalidate{%- endif %}
    {%- if hidden %} hidden{%- endif %}>

    {{ form.hidden_tag() }}
    {%- set ns = namespace(first_field=true) -%}

    {%- for field in form if field.widget.input_type != "hidden" %}
      <div id="{{ field.name }}-field">
        {%- if not loop.last %}
          {{ form_field(field, btn_type, btn_color, 3, ns.first_field and autofocus_first) }}
        {%- else %}
          {{ form_field(field, btn_type, btn_color, bottom_margin, ns.first_field and autofocus_first) }}
        {%- endif %}
        {%- set ns.first_field = false -%}
      </div>
    {%- endfor %}

    {{ turnstile }}
  </form>
{%- endmacro %}
